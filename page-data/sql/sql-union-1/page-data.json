{"componentChunkName":"component---src-templates-blog-post-js","path":"/sql/sql-union-1/","webpackCompilationHash":"244ee56c36e36966767c","result":{"data":{"site":{"siteMetadata":{"title":"温故而知新","author":"chao"}},"markdownRemark":{"id":"2137aa71-dffe-5701-af90-b597fa69a360","excerpt":"组合查询（一）组合查询大多数 SQL 查询语句都是使用单条 SELECT 语句来查询数据，但是 SQL 中也支持执行多个查询即多条 SELECT 语句，并且将结果作为一个查询集合返回，这样的查询被称为组合查询（compound query…","html":"<h2>组合查询（一）</h2>\n<h4>组合查询</h4>\n<p>大多数 SQL 查询语句都是使用单条 SELECT 语句来查询数据，但是 SQL 中也支持执行多个查询即多条 SELECT 语句，并且将结果作为一个查询集合返回，这样的查询被称为组合查询（compound query）</p>\n<p>需要使用组合查询的情况：</p>\n<ul>\n<li>在一个查询中从不同的表返回数据</li>\n<li>对一个表进行多次查询，安照一个查询结果返回</li>\n</ul>\n<h4>创建组合查询</h4>\n<p>使用 UNION 操作符可以组合多条 SQL 语句，并且返回将它们的结果组合成一个结果集</p>\n<p>下面要要查询多个地区的顾客报表，先使用单条 SELECT 语句</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Village Toys<span class=\"token operator\">|</span>John Smith<span class=\"token operator\">|</span>sales<span class=\"token variable\">@villagetoys.com</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nThe Toy Store<span class=\"token operator\">|</span>Kim Howard<span class=\"token operator\">|</span></code></pre></div>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Fun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nFun4All<span class=\"token operator\">|</span>Denise L<span class=\"token punctuation\">.</span> Stephens<span class=\"token operator\">|</span>dstephens<span class=\"token variable\">@fun4all.com</span></code></pre></div>\n<p>第一个 SELECT 语句查询了 ‘IL’、‘IN’、‘MI’ 地区的顾客信息，第二条 SELECT 语句查询顾客 ‘Fun4All’ 的信息</p>\n<p>使用 UNION 组合两条语句</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span>\n<span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Fun4All<span class=\"token operator\">|</span>Denise L<span class=\"token punctuation\">.</span> Stephens<span class=\"token operator\">|</span>dstephens<span class=\"token variable\">@fun4all.com</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nThe Toy Store<span class=\"token operator\">|</span>Kim Howard<span class=\"token operator\">|</span>\nVillage Toys<span class=\"token operator\">|</span>John Smith<span class=\"token operator\">|</span>sales<span class=\"token variable\">@villagetoys.com</span></code></pre></div>\n<p>这条 SQL 语句由前面的两条 SELECT 语句组成，使用 UNION 关键字分隔，输出结果组合成一个查询集合</p>\n<p>这里使用多个 WHERE 子句也可以实现，对于较为复杂或者多个表查询 UNION 可能会更简单</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">OR</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"组合查询（一）","date":"September 17, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/sql/sql-union-1/","previous":{"fields":{"slug":"/sql/sql-join-3/"},"frontmatter":{"title":"联结表（三）"}},"next":{"fields":{"slug":"/sql/sql-union-2/"},"frontmatter":{"title":"组合查询（二）"}}}}}