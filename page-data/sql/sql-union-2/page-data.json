{"componentChunkName":"component---src-templates-blog-post-js","path":"/sql/sql-union-2/","webpackCompilationHash":"244ee56c36e36966767c","result":{"data":{"site":{"siteMetadata":{"title":"温故而知新","author":"chao"}},"markdownRemark":{"id":"295318fc-0525-5234-80f7-56e35b7761b0","excerpt":"组合查询（二）UNION 规则UNION 使用起来很简单，但是需要注意以下规则UNION 必须由两条或两条以上的 SELECT 语句组成，语句之间使用关键字 UNION 分隔，比如有4条 SELECT，则需要3个 UNION 关键字 UNION…","html":"<h2>组合查询（二）</h2>\n<h4>UNION 规则</h4>\n<p>UNION 使用起来很简单，但是需要注意以下规则</p>\n<ul>\n<li>UNION 必须由两条或两条以上的 SELECT 语句组成，语句之间使用关键字 UNION 分隔，比如有4条 SELECT，则需要3个 UNION 关键字 </li>\n<li>UNION 中的每个查询必须包含相同的列、表达式或聚集函数</li>\n<li>列的数据类型必须兼容，类型不必完全相同，但必须是数据库可以隐含转换的类型</li>\n</ul>\n<h4>包含或取消重复的行</h4>\n<p>UNION 从查询结果集中自动去除了重复的行，如果需要返回所有匹配的行可以使用 UNION ALL</p>\n<p>使用 UNION</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span> \n<span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Fun4All<span class=\"token operator\">|</span>Denise L<span class=\"token punctuation\">.</span> Stephens<span class=\"token operator\">|</span>dstephens<span class=\"token variable\">@fun4all.com</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nThe Toy Store<span class=\"token operator\">|</span>Kim Howard<span class=\"token operator\">|</span>\nVillage Toys<span class=\"token operator\">|</span>John Smith<span class=\"token operator\">|</span>sales<span class=\"token variable\">@villagetoys.com</span></code></pre></div>\n<p>使用 UNION ALL</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span> <span class=\"token keyword\">ALL</span>\n<span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Village Toys<span class=\"token operator\">|</span>John Smith<span class=\"token operator\">|</span>sales<span class=\"token variable\">@villagetoys.com</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nThe Toy Store<span class=\"token operator\">|</span>Kim Howard<span class=\"token operator\">|</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nFun4All<span class=\"token operator\">|</span>Denise L<span class=\"token punctuation\">.</span> Stephens<span class=\"token operator\">|</span>dstephens<span class=\"token variable\">@fun4all.com</span></code></pre></div>\n<p>可以看到在使用 UNION ALL 时 <code class=\"language-text\">Fun4All|Jim Jones|jjones@fun4all.com</code> 行出现了两次</p>\n<h4>对组合结果排序</h4>\n<p>在使用 UNION 组合查询时，如果要进行排序，只能使用一条 ORDER BY 语句，并且必须位于最后一条 SELECT 语句之后</p>\n<p>输入</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_state <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'IL'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'IN'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'MI'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">UNION</span> \n<span class=\"token keyword\">SELECT</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">,</span> cust_email\n<span class=\"token keyword\">FROM</span> Customers\n<span class=\"token keyword\">WHERE</span> cust_name <span class=\"token operator\">=</span> <span class=\"token string\">'Fun4All'</span>\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> cust_name<span class=\"token punctuation\">,</span> cust_contact<span class=\"token punctuation\">;</span></code></pre></div>\n<p>输出</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\">Fun4All<span class=\"token operator\">|</span>Denise L<span class=\"token punctuation\">.</span> Stephens<span class=\"token operator\">|</span>dstephens<span class=\"token variable\">@fun4all.com</span>\nFun4All<span class=\"token operator\">|</span>Jim Jones<span class=\"token operator\">|</span>jjones<span class=\"token variable\">@fun4all.com</span>\nThe Toy Store<span class=\"token operator\">|</span>Kim Howard<span class=\"token operator\">|</span>\nVillage Toys<span class=\"token operator\">|</span>John Smith<span class=\"token operator\">|</span>sales<span class=\"token variable\">@villagetoys.com</span></code></pre></div>\n<p>上面的 SQL 语句中在 UNION 的最后一条 SELECT 语句使用了 ORDER BY 子句，虽然只是写在了最后一条 SELECT 语句中，但是是对所有结果的排序</p>","frontmatter":{"title":"组合查询（二）","date":"September 18, 2019","description":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/sql/sql-union-2/","previous":{"fields":{"slug":"/sql/sql-union-1/"},"frontmatter":{"title":"组合查询（一）"}},"next":{"fields":{"slug":"/sql/sql-insert-1/"},"frontmatter":{"title":"数据插入"}}}}}